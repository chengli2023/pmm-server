{"ast":null,"code":"import axios from 'axios';\nimport { onMounted, reactive, ref } from 'vue';\nimport { ElMessage } from 'element-plus';\nexport default {\n  name: 'ProjectList',\n\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    /* eslint-disable */\n\n    const dialogFormVisible = ref(false);\n    const formLabelWidth = '140px';\n    const projectList = reactive([]);\n    const projectForm = reactive({\n      id: '',\n      projectName: '',\n      pd: '',\n      proposer: '',\n      checker: '',\n      pm: '',\n      status: ''\n    });\n\n    const fetchProjectList = async function () {\n      projectList.splice(0, projectList.length);\n      const result = await axios.get('/api/project/list', {});\n\n      for (let index in result.data) {\n        projectList.push(result.data[index]);\n      } // projectList = result.data;\n\n    };\n\n    const createProject = async function () {\n      let res = {};\n      let isEditAction = projectForm.id ? true : false;\n\n      if (isEditAction) {\n        res = await axios.post('/api/project/editProject', projectForm);\n      } else {\n        res = await axios.post('/api/project/createProject', projectForm);\n      }\n\n      if (res.status == 200) {\n        ElMessage({\n          message: isEditAction ? '编辑成功' : '创建成功',\n          type: 'success'\n        });\n        dialogFormVisible.value = false;\n        fetchProjectList();\n      }\n    };\n\n    const editProject = async function (projectId) {\n      console.log(projectId);\n      const result = await axios.get(`/api/project/getById?projectId=${projectId}`, {});\n      console.log(result.data);\n      projectForm.id = result.data.id;\n      projectForm.projectName = result.data.projectName;\n      projectForm.pd = result.data.pd;\n      projectForm.proposer = result.data.proposer;\n      projectForm.checker = result.data.checker;\n      projectForm.pm = result.data.pm;\n      projectForm.status = result.data.status;\n      dialogFormVisible.value = true;\n    };\n\n    const openCreateDialog = function () {\n      projectForm.id = '';\n      projectForm.projectName = '';\n      projectForm.pd = '';\n      projectForm.proposer = '';\n      projectForm.checker = '';\n      projectForm.pm = '';\n      projectForm.status = '';\n      dialogFormVisible.value = true;\n    };\n\n    const deleteProject = async function (projectId) {\n      const res = await axios.post('/api/project/deleteProject', {\n        projectId: projectId\n      });\n\n      if (res.status == 200) {\n        ElMessage({\n          message: '删除成功',\n          type: 'success'\n        });\n        dialogFormVisible.value = false;\n        fetchProjectList();\n      }\n    };\n\n    const initFormData = function () {\n      this.projectForm.projectName = '';\n      this.projectForm.pd = '';\n      this.projectForm.proposer = '';\n      this.projectForm.checker = '';\n      this.projectForm.pm = '';\n      this.projectForm.status = '';\n    };\n\n    onMounted(fetchProjectList);\n    const __returned__ = {\n      dialogFormVisible,\n      formLabelWidth,\n      projectList,\n      projectForm,\n      fetchProjectList,\n      createProject,\n      editProject,\n      openCreateDialog,\n      deleteProject,\n      initFormData,\n      axios,\n      onMounted,\n      reactive,\n      ref,\n      ElMessage\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n\n};","map":{"version":3,"mappings":"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","names":["axios","onMounted","reactive","ref","ElMessage","dialogFormVisible","formLabelWidth","projectList","projectForm","id","projectName","pd","proposer","checker","pm","status","fetchProjectList","splice","length","result","get","index","data","push","createProject","res","isEditAction","post","message","type","value","editProject","projectId","console","log","openCreateDialog","deleteProject","initFormData"],"sources":["/Users/licheng/Documents/untitled/src/components/views/ProjectList.vue"],"sourcesContent":["<template>\n  <el-row>\n    <el-col :span=\"12\">\n      <el-breadcrumb>\n        <el-breadcrumb-item :to=\"{ path: '/projectList' }\">项目/需求</el-breadcrumb-item>\n      </el-breadcrumb>\n    </el-col>\n    <el-col :span=\"12\" style=\"text-align: right\">\n      <el-button type=\"primary\" @click=\"openCreateDialog\">创建项目</el-button>\n    </el-col>\n  </el-row>\n  <el-card class=\"project-card\">\n    <el-table :data=\"projectList\" style=\"width: 100%\">\n    <el-table-column fixed prop=\"projectName\" label=\"项目/需求名称\"  />\n    <el-table-column prop=\"proposer\" label=\"提出人\"  />\n    <el-table-column prop=\"pd\" label=\"产品经理\"  />\n    <el-table-column prop=\"checker\" label=\"验收人\" />\n    <el-table-column prop=\"pm\" label=\"项目经理\" />\n    <el-table-column prop=\"status\" label=\"状态\"/>\n    <el-table-column fixed=\"right\" label=\"操作\" >\n      <template #default=\"scope\">\n        <el-button link size=\"small\" @click=\"()=>{this.$router.push({\n        path:'projectPlanList',\n        query:{id:scope.row.id}\n        })}\">排期&任务</el-button>\n\n        <el-button text size=\"small\" @click=\"()=>{editProject(scope.row.id)}\">编辑</el-button>\n        <el-popconfirm title=\"Are you sure to delete this?\" @confirm=\"()=>{deleteProject(scope.row.id)}\">\n          <template  #reference>\n            <el-button text size=\"small\">删除</el-button>\n          </template>\n        </el-popconfirm>\n      </template>\n    </el-table-column>\n  </el-table>\n    <el-dialog v-model=\"dialogFormVisible\" title=\"创建/编辑项目\" close-on-click-modal:false close-on-press-escape:false>\n      <el-form :model=\"projectForm\">\n        <el-form-item label=\"项目名称\" :label-width=\"formLabelWidth\">\n          <el-input v-model=\"projectForm.projectName\" autocomplete=\"off\" />\n        </el-form-item>\n        <el-form-item label=\"提出人\" :label-width=\"formLabelWidth\">\n          <el-input v-model=\"projectForm.proposer\" autocomplete=\"off\" />\n        </el-form-item>\n        <el-form-item label=\"产品经理\" :label-width=\"formLabelWidth\">\n          <el-input v-model=\"projectForm.pd\" autocomplete=\"off\" />\n        </el-form-item>\n        <el-form-item label=\"验收人\" :label-width=\"formLabelWidth\">\n          <el-input v-model=\"projectForm.checker\" autocomplete=\"off\" />\n        </el-form-item>\n        <el-form-item label=\"项目经理\" :label-width=\"formLabelWidth\">\n          <el-input v-model=\"projectForm.pm\" autocomplete=\"off\" />\n        </el-form-item>\n        <el-form-item label=\"状态\" :label-width=\"formLabelWidth\">\n          <el-input v-model=\"projectForm.status\" autocomplete=\"off\" />\n        </el-form-item>\n\n  <!--      <el-form-item label=\"Zones\" :label-width=\"formLabelWidth\">\n          <el-select v-model=\"form.region\" placeholder=\"Please select a zone\">\n            <el-option label=\"Zone No.1\" value=\"shanghai\" />\n            <el-option label=\"Zone No.2\" value=\"beijing\" />\n          </el-select>\n        </el-form-item>-->\n      </el-form>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"dialogFormVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"createProject\"\n          >确认</el-button\n          >\n        </span>\n      </template>\n    </el-dialog>\n  </el-card>\n</template>\n\n<script setup>\n/* eslint-disable */\nimport axios from 'axios'\nimport {onMounted, reactive, ref} from 'vue'\nimport { ElMessage } from 'element-plus'\n\nconst dialogFormVisible = ref(false)\nconst formLabelWidth = '140px'\n\nconst projectList = reactive([])\nconst projectForm = reactive({\n  id:'',\n  projectName: '',\n  pd:'',\n  proposer: '',\n  checker: '',\n  pm: '',\n  status: ''\n})\n\nconst fetchProjectList = async function (){\n  projectList.splice(0,projectList.length)\n  const result = await axios.get('/api/project/list',{});\n  for(let index in result.data){\n    projectList.push(result.data[index])\n  }\n  // projectList = result.data;\n}\nconst createProject = async function(){\n  let res = {};\n  let isEditAction = projectForm.id?true:false;\n  if(isEditAction){\n    res = await axios.post('/api/project/editProject',projectForm);\n  }else {\n    res = await axios.post('/api/project/createProject',projectForm);\n  }\n  if(res.status == 200){\n    ElMessage({\n      message:isEditAction?'编辑成功':'创建成功',\n      type: 'success',\n    })\n    dialogFormVisible.value = false\n    fetchProjectList();\n  }\n}\nconst editProject = async function(projectId){\n  console.log(projectId)\n  const result = await axios.get(`/api/project/getById?projectId=${projectId}`,{});\n  console.log(result.data)\n\n  projectForm.id = result.data.id;\n  projectForm.projectName = result.data.projectName;\n  projectForm.pd = result.data.pd;\n  projectForm.proposer = result.data.proposer;\n  projectForm.checker = result.data.checker;\n  projectForm.pm = result.data.pm;\n  projectForm.status = result.data.status;\n\n  dialogFormVisible.value = true;\n}\nconst openCreateDialog = function (){\n  projectForm.id = '';\n  projectForm.projectName = '';\n  projectForm.pd = '';\n  projectForm.proposer = '';\n  projectForm.checker = '';\n  projectForm.pm = '';\n  projectForm.status = '';\n  dialogFormVisible.value = true;\n}\nconst deleteProject = async function(projectId){\n  const res = await axios.post('/api/project/deleteProject',{projectId:projectId});\n  if(res.status == 200){\n    ElMessage({\n      message: '删除成功',\n      type: 'success',\n    })\n    dialogFormVisible.value = false\n    fetchProjectList();\n  }\n}\nconst initFormData = function(){\n  this.projectForm.projectName = '';\n  this.projectForm.pd = '';\n  this.projectForm.proposer = '';\n  this.projectForm.checker = '';\n  this.projectForm.pm = '';\n  this.projectForm.status = '';\n}\nonMounted(\n    fetchProjectList\n)\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\nh3 {\n  margin: 40px 0 0;\n}\nul {\n  list-style-type: none;\n  padding: 0;\n}\nli {\n  display: inline-block;\n  margin: 0 10px;\n}\na {\n  color: #42b983;\n}\n.el-button--text {\n  margin-right: 15px;\n}\n.el-select {\n  width: 300px;\n}\n.el-input {\n  width: 300px;\n}\n.dialog-footer button:first-child {\n  margin-right: 10px;\n}\n.project-card {\n  margin: 20px 0px 10px 0px;\n  width: 100%;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}